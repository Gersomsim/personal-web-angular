@let article = post();

@if (loading()) {
	<!-- skeleton -->
	<div class="">
		<div class="flex gap-3 mb-2">
			<div class="animate-pulse rounded-md bg-slate-200 dark:bg-slate-800 h-5 w-10"></div>
			<div class="animate-pulse rounded-md bg-slate-200 dark:bg-slate-800 h-5 w-30"></div>
		</div>
		<div class="animate-pulse rounded-md bg-slate-200 dark:bg-slate-800 h-10 w-full mb-2"></div>
		<div class="animate-pulse rounded-md bg-slate-200 dark:bg-slate-800 h-5 w-full mb-2"></div>
		<div class="animate-pulse rounded-md bg-slate-200 dark:bg-slate-800 h-5 w-full mb-2"></div>
		<div class="flex gap-3 mb-2 items-center">
			<div class="animate-pulse rounded-full bg-slate-200 dark:bg-slate-800 h-14 w-14"></div>
			<div class="flex flex-col gap-2">
				<div class="animate-pulse rounded-md bg-slate-200 dark:bg-slate-800 h-5 w-30"></div>
				<div class="animate-pulse rounded-md bg-slate-200 dark:bg-slate-800 h-5 w-20"></div>
			</div>
			<div class="animate-pulse rounded-md bg-slate-200 dark:bg-slate-800 h-5 w-25"></div>
		</div>
		<div class="animate-pulse rounded-md bg-slate-200 dark:bg-slate-800 h-54 w-full mb-4"></div>
		<div class="animate-pulse rounded-md bg-slate-200 dark:bg-slate-800 h-5 w-full mb-2"></div>
		<div class="animate-pulse rounded-md bg-slate-200 dark:bg-slate-800 h-5 w-full mb-2"></div>
		<div class="animate-pulse rounded-md bg-slate-200 dark:bg-slate-800 h-5 w-full mb-2"></div>
		<div class="animate-pulse rounded-md bg-slate-200 dark:bg-slate-800 h-5 w-full mb-2"></div>
		<div class="animate-pulse rounded-md bg-slate-200 dark:bg-slate-800 h-5 w-full mb-2"></div>
		<div class="animate-pulse rounded-md bg-slate-200 dark:bg-slate-800 h-5 w-full mb-2"></div>
		<div class="animate-pulse rounded-md bg-slate-200 dark:bg-slate-800 h-5 w-full mb-2"></div>
		<div class="animate-pulse rounded-md bg-slate-200 dark:bg-slate-800 h-5 w-full mb-2"></div>
		<div class="animate-pulse rounded-md bg-slate-200 dark:bg-slate-800 h-5 w-full mb-2"></div>
		<div class="animate-pulse rounded-md bg-slate-200 dark:bg-slate-800 h-5 w-full mb-2"></div>
	</div>
}

@if (!article && !loading()) {
	<div class="mx-auto max-w-md py-20 text-center">
		<!-- Label -->
		<p class="font-mono text-[10px] uppercase tracking-widest text-emerald-500">// error</p>

		<!-- Terminal block -->
		<div class="mt-5 overflow-hidden rounded-lg border border-slate-200/50 text-left dark:border-slate-800/50">
			<!-- Chrome bar -->
			<div
				class="flex items-center gap-1.5 border-b border-slate-200/50 bg-slate-100 px-4 py-2.5 dark:border-slate-800/50 dark:bg-slate-800/80"
			>
				<span class="size-2.5 rounded-full bg-red-400/60"></span>
				<span class="size-2.5 rounded-full bg-amber-400/60"></span>
				<span class="size-2.5 rounded-full bg-emerald-400/60"></span>
				<span class="ml-3 font-mono text-[11px] text-slate-400 dark:text-slate-500">blog › fetch</span>
			</div>

			<!-- Terminal output -->
			<div class="space-y-1.5 bg-slate-900 px-5 py-4 font-mono text-sm">
				<p class="text-slate-500">
					$ GET /blog/
					<span class="text-slate-400">&#123;slug&#125;</span>
				</p>
				<p class="text-slate-600">↳ Resolving article...</p>
				<div class="h-px bg-slate-800 my-2"></div>
				<p class="text-red-400/90">✗ Error: ArticleNotFoundError</p>
				<p class="pl-4 text-xs text-slate-500">
					status
					<span class="text-slate-600">:</span>
					<span class="text-amber-400/80">404</span>
				</p>
				<p class="pl-4 text-xs text-slate-500">
					message
					<span class="text-slate-600">:</span>
					<span class="text-slate-400">"El artículo no existe o fue removido"</span>
				</p>
				<p class="pt-1 text-slate-600">
					$
					<span class="cursor text-emerald-400">_</span>
				</p>
			</div>
		</div>

		<!-- Human explanation -->
		<p class="mt-6 text-sm leading-relaxed text-slate-500 dark:text-slate-400">
			El enlace puede estar roto o el artículo fue movido.
			<br />
			Prueba buscando desde el listado del blog.
		</p>

		<!-- Actions -->
		<div class="mt-7 flex flex-wrap items-center justify-center gap-3">
			<a
				routerLink="/blog"
				class="inline-flex items-center gap-2 rounded-md bg-emerald-500 px-5 py-2.5 text-sm font-medium text-white transition-colors hover:bg-emerald-600"
			>
				<svg
					class="size-4"
					fill="none"
					viewBox="0 0 24 24"
					stroke-width="2"
					stroke="currentColor"
				>
					<path
						stroke-linecap="round"
						stroke-linejoin="round"
						d="M10.5 19.5 3 12m0 0 7.5-7.5M3 12h18"
					/>
				</svg>
				Volver al blog
			</a>
			<a
				routerLink="/"
				class="inline-flex items-center gap-2 rounded-md border border-slate-200 px-5 py-2.5 text-sm font-medium text-slate-600 transition-colors hover:bg-slate-50 dark:border-slate-700 dark:text-slate-400 dark:hover:bg-slate-800/60"
			>
				Ir al inicio
			</a>
		</div>
	</div>
}

@if (article && !loading()) {
	<article class="w-full">
		<div class="animate-fade-in duration-500 ease-out">
			<header class="py-6">
				<div class="mx-auto">
					<!-- Breadcrumb -->
					<nav class="mb-8 flex items-center gap-2 text-sm text-slate-500">
						<a
							routerLink="/blog"
							class="transition-colors hover:text-emerald-500"
						>
							Blog
						</a>
						<svg
							class="size-4"
							fill="none"
							viewBox="0 0 24 24"
							stroke-width="2"
							stroke="currentColor"
						>
							<path
								stroke-linecap="round"
								stroke-linejoin="round"
								d="m8.25 4.5 7.5 7.5-7.5 7.5"
							/>
						</svg>
						<span class="text-slate-400">{{ article.category.name }}</span>
					</nav>

					<!-- Title -->
					<h1
						class="text-3xl font-bold tracking-tight text-slate-900 dark:text-white sm:text-4xl lg:text-5xl"
					>
						{{ article.title }}
					</h1>

					<!-- Excerpt -->
					<p class="mt-4 text-xl text-slate-600 dark:text-slate-400">
						{{ article.excerpt }}
					</p>

					<!-- Meta -->
					<div class="mt-8 flex flex-wrap items-center gap-6">
						<!-- Author -->
						<div class="flex items-center gap-3">
							<img
								[src]="article.author.image"
								[alt]="article.author.name"
								class="size-10 rounded-full object-cover"
							/>
							<div>
								<p class="text-sm font-medium text-slate-900 dark:text-white">
									{{ article.author.name }}
								</p>
								<p class="text-sm text-slate-500">{{ article.updatedAt | date }}</p>
							</div>
						</div>

						<div class="hidden h-6 w-px bg-slate-200 dark:bg-slate-700 sm:block"></div>

						<!-- Read time -->
						<div class="flex items-center gap-2 text-sm text-slate-500">
							<svg
								class="size-4"
								fill="none"
								viewBox="0 0 24 24"
								stroke-width="2"
								stroke="currentColor"
							>
								<path
									stroke-linecap="round"
									stroke-linejoin="round"
									d="M12 6v6h4.5m4.5 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"
								/>
							</svg>
							{{ article.readTime }} lectura
						</div>

						<div class="hidden h-6 w-px bg-slate-200 dark:bg-slate-700 sm:block"></div>

						<!-- Tags -->
						<app-tags-list [tags]="article.tags" />
					</div>
				</div>
			</header>

			<!-- Featured Image -->
			@if (article.image; as image) {
				<div class="mx-auto max-w-5xl px-6 lg:px-8">
					<div class="aspect-[2/1] overflow-hidden rounded-xl bg-slate-100 dark:bg-slate-800">
						<img
							[src]="image.url"
							[alt]="article.title"
							class="size-full object-cover"
						/>
					</div>
				</div>
			}

			<!-- ── Contenido del artículo ────────────────────────────────────── -->
			<div class="mx-auto py-12">
				<app-markdown [content]="article.content" />
			</div>

			<!-- ============================================
       COMMENTS SECTION
       ============================================ -->
			<section class="border-t border-slate-200/50 py-16 dark:border-slate-800/50">
				<div class="mx-auto max-w-3xl px-6 lg:px-8">
					<h2 class="flex items-center gap-2 text-xl font-bold text-slate-900 dark:text-white">
						<svg
							class="size-5 text-emerald-500"
							fill="none"
							viewBox="0 0 24 24"
							stroke-width="2"
							stroke="currentColor"
						>
							<path
								stroke-linecap="round"
								stroke-linejoin="round"
								d="M7.5 8.25h9m-9 3H12m-9.75 1.51c0 1.6 1.123 2.994 2.707 3.227 1.129.166 2.27.293 3.423.379.35.026.67.21.865.501L12 21l2.755-4.133a1.14 1.14 0 0 1 .865-.501 48.172 48.172 0 0 0 3.423-.379c1.584-.233 2.707-1.626 2.707-3.228V6.741c0-1.602-1.123-2.995-2.707-3.228A48.394 48.394 0 0 0 12 3c-2.392 0-4.744.175-7.043.513C3.373 3.746 2.25 5.14 2.25 6.741v6.018Z"
							/>
						</svg>
						Comentarios
					</h2>
					<p class="mt-2 text-slate-600 dark:text-slate-400">
						¿Tienes preguntas o comentarios? Me encantaría escuchar tu experiencia.
					</p>

					<!-- Giscus Placeholder -->
					<div
						class="mt-8 rounded-lg border border-dashed border-slate-300 bg-slate-50 p-8 text-center dark:border-slate-700 dark:bg-slate-900/50"
					>
						<svg
							class="mx-auto size-12 text-slate-300 dark:text-slate-600"
							fill="none"
							viewBox="0 0 24 24"
							stroke-width="1.5"
							stroke="currentColor"
						>
							<path
								stroke-linecap="round"
								stroke-linejoin="round"
								d="M8.625 12a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm0 0H8.25m4.125 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm0 0H12m4.125 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm0 0h-.375M21 12c0 4.556-4.03 8.25-9 8.25a9.764 9.764 0 0 1-2.555-.337A5.972 5.972 0 0 1 5.41 20.97a5.969 5.969 0 0 1-.474-.065 4.48 4.48 0 0 0 .978-2.025c.09-.457-.133-.901-.467-1.226C3.93 16.178 3 14.189 3 12c0-4.556 4.03-8.25 9-8.25s9 3.694 9 8.25Z"
							/>
						</svg>
						<p class="mt-4 text-sm text-slate-500">
							Sistema de comentarios con
							<strong>Giscus</strong>
							(GitHub Discussions)
						</p>
						<p class="mt-1 font-mono text-xs text-slate-400">&lt;giscus-component /&gt;</p>
					</div>
				</div>
			</section>
		</div>
	</article>
}
