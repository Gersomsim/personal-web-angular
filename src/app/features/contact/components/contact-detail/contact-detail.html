@if (loading()) {
	<!-- Loading skeleton -->
	<div class="grid gap-6 lg:grid-cols-[1fr_260px]">
		<div class="space-y-4">
			<div class="h-7 w-64 animate-pulse rounded bg-slate-100 dark:bg-slate-800"></div>
			<div class="h-4 w-40 animate-pulse rounded bg-slate-100 dark:bg-slate-800"></div>
			<div class="mt-6 space-y-2">
				<div class="h-4 w-full animate-pulse rounded bg-slate-100 dark:bg-slate-800"></div>
				<div class="h-4 w-full animate-pulse rounded bg-slate-100 dark:bg-slate-800"></div>
				<div class="h-4 w-3/4 animate-pulse rounded bg-slate-100 dark:bg-slate-800"></div>
			</div>
		</div>
		<div class="space-y-3">
			<div class="h-24 animate-pulse rounded-lg bg-slate-100 dark:bg-slate-800"></div>
			<div class="h-16 animate-pulse rounded-lg bg-slate-100 dark:bg-slate-800"></div>
		</div>
	</div>
}

@else if (message(); as msg) {
	<div class="grid gap-6 lg:grid-cols-[1fr_260px]">

		<!-- ===== MESSAGE BODY ===== -->
		<div class="min-w-0">
			<!-- Sender -->
			<div class="mb-6">
				<h1 class="text-2xl font-semibold tracking-tight text-slate-900 dark:text-white">
					{{ msg.name }}
				</h1>
				<p class="mt-1 font-mono text-sm text-slate-500 dark:text-slate-400">{{ msg.email }}</p>
			</div>

			<!-- Subject -->
			<div class="mb-4">
				<p class="mb-1 font-mono text-xs text-emerald-500">// asunto</p>
				<p class="text-lg font-medium text-slate-900 dark:text-white">{{ msg.subject }}</p>
			</div>

			<!-- Message content -->
			<div class="rounded-lg border border-slate-200/50 bg-slate-50/50 p-6 dark:border-slate-800/50 dark:bg-slate-900/30">
				<p class="whitespace-pre-wrap leading-relaxed text-slate-700 dark:text-slate-300">{{ msg.message }}</p>
			</div>
		</div>

		<!-- ===== METADATA PANEL ===== -->
		<div class="space-y-3 lg:pt-0">

			<!-- Date card -->
			<div class="rounded-lg border border-slate-200/50 p-4 dark:border-slate-800/50">
				<p class="mb-1 font-mono text-[10px] uppercase tracking-widest text-slate-400 dark:text-slate-600">Recibido</p>
				<p class="font-mono text-sm text-slate-900 dark:text-white">{{ msg.createdAt | date: 'dd/MM/yyyy' }}</p>
				<p class="font-mono text-xs text-slate-500 dark:text-slate-400">{{ msg.createdAt | date: 'HH:mm' }}</p>
			</div>

			<!-- Status card -->
			<div class="rounded-lg border border-slate-200/50 p-4 dark:border-slate-800/50">
				<p class="mb-2 font-mono text-[10px] uppercase tracking-widest text-slate-400 dark:text-slate-600">Estado</p>
				@if (msg.read) {
					<div class="flex items-center gap-2">
						<span class="size-1.5 rounded-full bg-slate-300 dark:bg-slate-600"></span>
						<span class="font-mono text-xs text-slate-500 dark:text-slate-400">leído</span>
					</div>
					<button
						type="button"
						(click)="markReadRequested.emit()"
						class="mt-3 w-full rounded-md border border-slate-200/50 px-3 py-1.5 font-mono text-xs text-slate-500 transition-colors hover:border-slate-300 hover:text-slate-700 dark:border-slate-800/50 dark:hover:border-slate-700 dark:hover:text-slate-300"
					>
						Marcar como no leído
					</button>
				} @else {
					<div class="flex items-center gap-2">
						<span class="size-1.5 rounded-full bg-emerald-500"></span>
						<span class="font-mono text-xs font-medium text-emerald-600 dark:text-emerald-400">no leído</span>
					</div>
					<button
						type="button"
						(click)="markReadRequested.emit()"
						class="mt-3 w-full rounded-md bg-emerald-500/10 px-3 py-1.5 font-mono text-xs font-medium text-emerald-600 transition-colors hover:bg-emerald-500/20 dark:text-emerald-400"
					>
						Marcar como leído
					</button>
				}
			</div>

			<!-- Delete action -->
			<button
				type="button"
				(click)="deleteRequested.emit()"
				class="w-full rounded-lg border border-slate-200/50 px-4 py-2.5 font-mono text-xs text-slate-400 transition-colors hover:border-red-200 hover:bg-red-50/50 hover:text-red-600 dark:border-slate-800/50 dark:hover:border-red-900/50 dark:hover:bg-red-950/20 dark:hover:text-red-400"
			>
				Eliminar mensaje
			</button>
		</div>
	</div>
}
