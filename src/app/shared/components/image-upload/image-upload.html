<div class="space-y-1.5">
	@if (label()) {
		<label class="font-mono text-xs font-medium text-slate-500 dark:text-slate-400">{{ label() }}</label>
	}

	<!-- Drop zone -->
	<div
		[class]="dropZoneClasses()"
		(dragover)="onDragOver($event)"
		(dragleave)="onDragLeave($event)"
		(drop)="onDrop($event)"
		(click)="openPicker(fileInput)"
	>
		<input
			#fileInput
			type="file"
			accept="image/*"
			multiple
			class="hidden"
			(change)="onFileInput($event)"
		/>

		<div class="flex flex-col items-center gap-2 px-4 py-6">
			<svg
				class="size-4 text-slate-400 dark:text-slate-600"
				fill="none"
				viewBox="0 0 24 24"
				stroke-width="1.5"
				stroke="currentColor"
			>
				<path
					stroke-linecap="round"
					stroke-linejoin="round"
					d="M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5m-13.5-9L12 3m0 0 4.5 4.5M12 3v13.5"
				/>
			</svg>
			<p class="font-mono text-xs text-slate-500 dark:text-slate-400">
				arrastra o
				<span class="text-emerald-500 dark:text-emerald-400">selecciona imágenes</span>
			</p>
			<p class="font-mono text-[10px] text-slate-400 dark:text-slate-600">jpg · png · webp · gif</p>
		</div>
	</div>

	<!-- Thumbnails grid -->
	@if (files().length > 0 || queue().length > 0) {
		<div class="grid grid-cols-4 gap-2 pt-1 sm:grid-cols-5">
			@for (file of files(); track file.id) {
				<div class="group relative aspect-square overflow-hidden rounded-md border border-slate-200/50 dark:border-slate-800/50">
					<img
						[src]="file.url"
						[alt]="file.name"
						class="size-full object-cover"
					/>
					<button
						type="button"
						(click)="remove(file.id)"
						class="absolute right-1 top-1 flex size-5 items-center justify-center rounded-sm bg-slate-950/70 text-white opacity-0 transition-opacity hover:bg-red-900/80 hover:text-red-300 group-hover:opacity-100"
					>
						<svg
							class="size-3"
							fill="none"
							viewBox="0 0 24 24"
							stroke-width="2"
							stroke="currentColor"
						>
							<path
								stroke-linecap="round"
								stroke-linejoin="round"
								d="M6 18 18 6M6 6l12 12"
							/>
						</svg>
					</button>
				</div>
			}
			@for (item of queue(); track item.preview) {
				<div class="relative aspect-square overflow-hidden rounded-md border border-slate-200/50 dark:border-slate-800/50">
					<img
						[src]="item.preview"
						[alt]="item.name"
						class="size-full object-cover opacity-40"
					/>
					<div class="absolute inset-0 flex items-center justify-center">
						<div class="size-4 animate-spin rounded-full border-2 border-emerald-500 border-t-transparent"></div>
					</div>
				</div>
			}
		</div>

		<p class="font-mono text-[10px] text-slate-400 dark:text-slate-600">
			{{ files().length.toString().padStart(2, '0') }}
			{{ files().length === 1 ? 'imagen' : 'imágenes' }}
			@if (queue().length > 0) {
				<span class="text-emerald-500">· subiendo {{ queue().length }}&#8230;</span>
			}
		</p>
	}

	@if (hint()) {
		<p class="font-mono text-[10px] text-slate-400 dark:text-slate-600">{{ hint() }}</p>
	}
</div>
